"""
–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –ø—Ä–æ–º–ø—Ç–æ–≤ –¥–ª—è GPT –º–æ–¥–µ–ª–µ–π.

–î–∞–Ω–Ω—ã–π –º–æ–¥—É–ª—å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö –∏ –ø–æ—Å—Ç—Ä–æ–∏—Ç–µ–ª–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è 
—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–æ–º–ø—Ç–æ–≤ –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö GPT –º–æ–¥–µ–ª–µ–π. –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ 
—Ç–∏–ø—ã –∫–æ–Ω—Ç–µ–Ω—Ç–∞, –≤–∫–ª—é—á–∞—è –ø–æ—Å—Ç—ã –≤ —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–µ—Ç—è—Ö, –∫–æ–Ω—Ç–µ–Ω—Ç-–ø–ª–∞–Ω—ã –∏ –∑–∞–ø—Ä–æ—Å—ã 
–Ω–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞.
"""

from abc import ABC, abstractmethod
from typing import Dict, Union, Any, Iterable, List, Mapping
import logging
import textwrap
from dataclasses import dataclass, field

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –º–æ–¥—É–ª—è
logger = logging.getLogger(__name__)


@dataclass
class PromptContext:
    """
    –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–ª—è –ø—Ä–æ–º–ø—Ç–æ–≤ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞.
    
    –°–æ–¥–µ—Ä–∂–∏—Ç –≤—Å—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –Ω–µ–æ–±—Ö–æ–¥–∏–º—É—é –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–µ—Ç–µ–π,
    –≤–∫–ª—é—á–∞—è –¥–µ—Ç–∞–ª–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π, –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –ù–ö–û, —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
    –∏ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è —Å—Ç–∏–ª—è –ø–æ–≤–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è.
    
    Attributes:
        goal (str): –¶–µ–ª—å —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
        audience (list[str]): –¶–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è
        platform (str): –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
        content_format (list[str]): –§–æ—Ä–º–∞—Ç –∫–æ–Ω—Ç–µ–Ω—Ç–∞
        volume (str): –û–±—ä–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç–∞
        event_details (dict[str, str]): –î–µ—Ç–∞–ª–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è
        has_event (bool): –ù–∞–ª–∏—á–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–∏
        event_type (str): –¢–∏–ø –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è
        event_date (str): –î–∞—Ç–∞ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è
        event_place (str): –ú–µ—Å—Ç–æ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è
        event_audience (str): –¶–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è
        narrative_style (str): –°—Ç–∏–ª—å –ø–æ–≤–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è
        has_ngo_info (bool): –ù–∞–ª–∏—á–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –ù–ö–û
        ngo_name (str): –ù–∞–∑–≤–∞–Ω–∏–µ –ù–ö–û
        ngo_description (str): –û–ø–∏—Å–∞–Ω–∏–µ –ù–ö–û
        ngo_activities (str): –î–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ù–ö–û
        ngo_contact (str): –ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ù–ö–û
    """
    goal: str = ""
    audience: list[str] = field(default_factory=list)
    platform: str = ""
    content_format: list[str] = field(default_factory=list)
    volume: str = ""
    event_details: dict[str, str] = field(default_factory=dict)
    has_event: bool = False
    
    # –ü–æ–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ñ–æ—Ä–º—ã
    event_type: str = ""
    event_date: str = ""
    event_place: str = ""
    event_audience: str = ""
    narrative_style: str = ""
    
    # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –ù–ö–û
    has_ngo_info: bool = False
    ngo_name: str = ""
    ngo_description: str = ""
    ngo_activities: str = ""
    ngo_contact: str = ""

    @classmethod
    def from_dict(cls, data: Mapping[str, Any]) -> "PromptContext":
        """
        –°–æ–∑–¥–∞–µ—Ç —ç–∫–∑–µ–º–ø–ª—è—Ä PromptContext –∏–∑ —Å–ª–æ–≤–∞—Ä–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
        
        Args:
            data (Mapping[str, Any]): –°–ª–æ–≤–∞—Ä—å, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –¥–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
            
        Returns:
            PromptContext: –ù–æ–≤—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä —Å –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ —Å–ª–æ–≤–∞—Ä—è
        """
        return cls(
            goal=data.get("goal", ""),
            audience=data.get("audience", []),
            platform=data.get("platform", ""),
            content_format=data.get("format", []),
            volume=data.get("volume", ""),
            event_details=data.get("event_details", {}),
            has_event=bool(data.get("has_event", False)),
            # –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—è
            event_type=data.get("event_type", ""),
            event_date=data.get("event_date", ""),
            event_place=data.get("event_place", ""),
            event_audience=data.get("event_audience", ""),
            narrative_style=data.get("narrative_style", ""),
            # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –ù–ö–û
            has_ngo_info=bool(data.get("has_ngo_info", False)),
            ngo_name=data.get("ngo_name", ""),
            ngo_description=data.get("ngo_description", ""),
            ngo_activities=data.get("ngo_activities", ""),
            ngo_contact=data.get("ngo_contact", ""),
        )


@dataclass
class PlanPromptContext:
    """
    –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–ª—è –ø—Ä–æ–º–ø—Ç–æ–≤ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞.
    
    –°–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –Ω–µ–æ–±—Ö–æ–¥–∏–º—É—é –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç-–ø–ª–∞–Ω–æ–≤, –≤–∫–ª—é—á–∞—è
    –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–µ—Ä–∏–æ–¥—ã, —á–∞—Å—Ç–æ—Ç—É –ø—É–±–ª–∏–∫–∞—Ü–∏–π, —Ç–µ–º—ã –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è.
    
    Attributes:
        period (str): –ü–µ—Ä–∏–æ–¥ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
        frequency (str): –ß–∞—Å—Ç–æ—Ç–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–π
        themes (str): –¢–µ–º—ã –∫–æ–Ω—Ç–µ–Ω—Ç–∞
        details (str): –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ—Ç–∞–ª–∏
    """
    period: str = ""
    frequency: str = ""
    themes: str = ""
    details: str = ""

    @classmethod
    def from_dict(cls, data: Mapping[str, Any]) -> "PlanPromptContext":
        """
        –°–æ–∑–¥–∞–µ—Ç —ç–∫–∑–µ–º–ø–ª—è—Ä PlanPromptContext –∏–∑ —Å–ª–æ–≤–∞—Ä–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
        
        Args:
            data (Mapping[str, Any]): –°–ª–æ–≤–∞—Ä—å, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –¥–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø–ª–∞–Ω–∞
            
        Returns:
            PlanPromptContext: –ù–æ–≤—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä —Å –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ —Å–ª–æ–≤–∞—Ä—è
        """
        return cls(
            period=data.get("period", ""),
            frequency=data.get("frequency", ""),
            themes=data.get("themes", ""),
            details=data.get("details", ""),
        )


@dataclass
class EditPromptContext:
    """
    –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–ª—è –ø—Ä–æ–º–ø—Ç–æ–≤ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–∞.
    
    –°–æ–¥–µ—Ä–∂–∏—Ç —Ç–µ–∫—Å—Ç –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤–º–µ—Å—Ç–µ —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º,
    –≤–∫–ª—é—á–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –ù–ö–û, –∫–æ—Ç–æ—Ä–∞—è –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ–π –¥–ª—è –ø—Ä–æ—Ü–µ—Å—Å–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.
    
    Attributes:
        text_to_edit (str): –¢–µ–∫—Å—Ç –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        details (str): –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ—Ç–∞–ª–∏
        has_ngo_info (bool): –ù–∞–ª–∏—á–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –ù–ö–û
        ngo_name (str): –ù–∞–∑–≤–∞–Ω–∏–µ –ù–ö–û
        ngo_description (str): –û–ø–∏—Å–∞–Ω–∏–µ –ù–ö–û
        ngo_activities (str): –î–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ù–ö–û
        ngo_contact (str): –ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ù–ö–û
    """
    text_to_edit: str = ""
    details: str = ""
    # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –ù–ö–û
    has_ngo_info: bool = False
    ngo_name: str = ""
    ngo_description: str = ""
    ngo_activities: str = ""
    ngo_contact: str = ""

    @classmethod
    def from_dict(cls, data: Mapping[str, Any]) -> "EditPromptContext":
        """
        –°–æ–∑–¥–∞–µ—Ç —ç–∫–∑–µ–º–ø–ª—è—Ä EditPromptContext –∏–∑ —Å–ª–æ–≤–∞—Ä–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
        
        Args:
            data (Mapping[str, Any]): –°–ª–æ–≤–∞—Ä—å, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –¥–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
            
        Returns:
            EditPromptContext: –ù–æ–≤—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä —Å –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ —Å–ª–æ–≤–∞—Ä—è
        """
        return cls(
            text_to_edit=data.get("text_to_edit", ""),
            details=data.get("details", ""),
            # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –ù–ö–û
            has_ngo_info=bool(data.get("has_ngo_info", False)),
            ngo_name=data.get("ngo_name", ""),
            ngo_description=data.get("ngo_description", ""),
            ngo_activities=data.get("ngo_activities", ""),
            ngo_contact=data.get("ngo_contact", ""),
        )


class AbstractPromptBuilder(ABC):
    """
    –ê–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–π –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è GPT –ø—Ä–æ–º–ø—Ç–æ–≤.
    
    –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤—Å–µ—Ö –ø–æ—Å—Ç—Ä–æ–∏—Ç–µ–ª–µ–π –ø—Ä–æ–º–ø—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–∑–¥–∞—é—Ç
    —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞.
    """
    
    @abstractmethod
    def build_text_content_prompt(self, user_data: PromptContext, user_text: str) -> str:
        """
        –°–æ–∑–¥–∞–µ—Ç –ø—Ä–æ–º–ø—Ç –¥–ª—è –æ–±—â–µ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞.
        
        Args:
            user_data (PromptContext): –î–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
            user_text (str): –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            
        Returns:
            str: –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
        """
        pass

    @abstractmethod
    def build_refactor_text_content_prompt(self, user_data: PromptContext, generated_post: str, user_text: str) -> str:
        """
        –°–æ–∑–¥–∞–µ—Ç –ø—Ä–æ–º–ø—Ç –¥–ª—è —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞.
        
        Args:
            user_data (PromptContext): –î–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
            generated_post (str): –¢–µ–∫—Å—Ç–æ–≤—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞
            user_text (str): –ó–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥
            
        Returns:
            str: –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
        """
        pass

    @abstractmethod
    def build_card_content_prompt(self, user_data: PromptContext, full_content: str) -> str:
        """
        –°–æ–∑–¥–∞–µ—Ç –ø—Ä–æ–º–ø—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∫–∞—Ä—Ç–æ—á–∫–∏ (–∫–æ—Ä–æ—Ç–∫–∞—è –≤–µ—Ä—Å–∏—è).
        
        Args:
            user_data (PromptContext): –î–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
            full_content (str): –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è —Å–æ–∫—Ä–∞—â–µ–Ω–∏—è –¥–ª—è –∫–∞—Ä—Ç–æ—á–∫–∏
            
        Returns:
            str: –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∫–∞—Ä—Ç–æ—á–∫–∏
        """
        pass


class YandexGPTPromptBuilder(AbstractPromptBuilder):
    """
    –ü–æ—Å—Ç—Ä–æ–∏—Ç–µ–ª—å –ø—Ä–æ–º–ø—Ç–æ–≤ –¥–ª—è YandexGPT API.
    
    –°–æ–∑–¥–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã –¥–ª—è YandexGPT, –∫–æ—Ç–æ—Ä—ã–µ –≤–∫–ª—é—á–∞—é—Ç –¥–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞,
    —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã, –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –ù–ö–û –∏ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞.
    """

    def build_text_content_prompt(self, user_data: PromptContext, user_text: str) -> str:
        """
        –°–æ–∑–¥–∞–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–µ—Ç–µ–π.
        
        –°–æ–∑–¥–∞–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ–º–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π –≤–∫–ª—é—á–∞–µ—Ç —Å—Ç–∏–ª—å –ø–æ–≤–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è, —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã,
        –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –ù–ö–û –∏ –ø—Ä–∏–º–µ—Ä—ã –ø–æ—Å—Ç–æ–≤ –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞.
        
        Args:
            user_data (PromptContext): –î–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            user_text (str): –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∏–ª–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            
        Returns:
            str: –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
        """
        sections = []
        
        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å—Ç–∏–ª—å –ø–æ–≤–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è
        narrative_style = self._get_narrative_style(user_data.narrative_style)
        sections.append(f"–°—Ç–∏–ª—å –ø–æ–≤–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è: {narrative_style}")

        # –ò—Å–ø–æ–ª—å–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ñ–æ—Ä–º—ã, –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã
        if user_data.event_type or user_data.event_date:
            sections.extend([
                "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Å—Ç–∞:",
                f"‚Ä¢ –ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ: {user_data.event_type}",
                f"‚Ä¢ –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è: {user_data.event_date}",
                f"‚Ä¢ –ú–µ—Å—Ç–æ: {user_data.event_place}",
                f"‚Ä¢ –¶–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è: {user_data.event_audience}",
                f"‚Ä¢ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ—Ç–∞–ª–∏: {user_data.event_details}",
            ])
        else:
            # –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
            sections.append("–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:")
            sections.append(user_text.strip())

        # –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –ù–ö–û, –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–∞
        if user_data.has_ngo_info and user_data.ngo_name:
            sections.extend([
                "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –ù–ö–û:",
                f"‚Ä¢ –ù–∞–∑–≤–∞–Ω–∏–µ: {user_data.ngo_name}",
            ])
            if user_data.ngo_description and user_data.ngo_description != "–ù–µ —É–∫–∞–∑–∞–Ω–æ":
                sections.append(f"‚Ä¢ –û–ø–∏—Å–∞–Ω–∏–µ: {user_data.ngo_description}")
            if user_data.ngo_activities and user_data.ngo_activities != "–ù–µ —É–∫–∞–∑–∞–Ω–æ":
                sections.append(f"‚Ä¢ –î–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å: {user_data.ngo_activities}")
            if user_data.ngo_contact and user_data.ngo_contact != "–ù–µ —É–∫–∞–∑–∞–Ω–æ":
                sections.append(f"‚Ä¢ –ö–æ–Ω—Ç–∞–∫—Ç—ã: {user_data.ngo_contact}")
            sections.append("–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–æ—Å—Ç–∞.")

        sections.extend([
            f"–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞: {user_data.platform} ({self._get_platform_requirements(user_data.platform)})",
            "–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:",
            "‚Ä¢ –ù–µ —É–ø–æ–º–∏–Ω–∞—Ç—å —Ä–µ–∂–∏–º–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, –≤–æ–µ–Ω–Ω—ã–µ –±–∞–∑—ã –∏–ª–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ –ø–µ—Ä–µ–¥–≤–∏–∂–µ–Ω–∏–µ.",
            "‚Ä¢ –§–æ–∫—É—Å–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ —Å–æ—Ü–∏–∞–ª—å–Ω–æ–π –º–∏—Å—Å–∏–∏ –∏ –ø–æ–º–æ—â–∏ –ª—é–¥—è–º.",
            "‚Ä¢ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏ –ø—Ä–∏–∑—ã–≤ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –¥–µ–π—Å—Ç–≤–∏—é.",
            "‚Ä¢ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –¥–æ–±–∞–≤–∏—Ç—å 3-5 —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —Ö–µ—à—Ç–µ–≥–æ–≤ –≤ –∫–æ–Ω—Ü–µ –ø–æ—Å—Ç–∞ –ø–æ —Ç–µ–º–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è/–ø–æ—Å—Ç–∞.",
        ])

        sections.append("–ü—Ä–∏–º–µ—Ä—ã —É—Å–ø–µ—à–Ω—ã—Ö –ø–æ—Å—Ç–æ–≤ –¥–ª—è –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏—è:")
        sections.extend(
            [
                '‚Ä¢ "üåü –î—Ä—É–∑—å—è, –Ω–∞–º –Ω—É–∂–Ω—ã –≤–æ–ª–æ–Ω—Ç–µ—Ä—ã! –ü–æ–º–æ–≥–∏—Ç–µ –¥–µ—Ç—è–º –∏–∑ –º–Ω–æ–≥–æ–¥–µ—Ç–Ω—ã—Ö —Å–µ–º–µ–π –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å—Å—è –∫ —à–∫–æ–ª–µ. –í–∞—à–µ —É—á–∞—Å—Ç–∏–µ –∏–∑–º–µ–Ω–∏—Ç –∂–∏–∑–Ω–∏ —ç—Ç–∏—Ö –¥–µ—Ç–µ–π!"',
                '‚Ä¢ "üí° –í–∞—à–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–∞–∂–Ω–∞! –ë–ª–∞–≥–æ–¥–∞—Ä—è –≤–∞–º –º—ã —Å–æ–±—Ä–∞–ª–∏ 100 –Ω–∞–±–æ—Ä–æ–≤ —à–∫–æ–ª—å–Ω—ã—Ö –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–µ–π –¥–ª—è –¥–µ—Ç–µ–π –≤ –Ω–∞—à–µ–º –≥–æ—Ä–æ–¥–µ."',
                '‚Ä¢ "–ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Ç–µ—Å—å –∫ –Ω–∞–º –Ω–∞ –±–ª–∞–≥–æ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ–º –∫–æ–Ω—Ü–µ—Ä—Ç–µ! 15 –¥–µ–∫–∞–±—Ä—è –≤ –î–ö \"–†–æ–¥–∏–Ω–∞\". –í—Å–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ –ø–æ–π–¥—É—Ç –Ω–∞ —Ä–µ–º–æ–Ω—Ç –¥–µ—Ç—Å–∫–æ–π –ø–ª–æ—â–∞–¥–∫–∏."',
            ]
        )

        sections.append(
            "–û—Ç–≤–µ—á–∞–π—Ç–µ —Ç–æ–ª—å–∫–æ –≥–æ—Ç–æ–≤—ã–º —Ç–µ–∫—Å—Ç–æ–º –ø–æ—Å—Ç–∞, –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –∏ –ø–æ—è—Å–Ω–µ–Ω–∏–π."
        )

        prompt = "\n".join(sections)
        return textwrap.dedent(prompt).strip()

    def build_card_content_prompt(self, user_data: PromptContext, full_content: str) -> str:
        """
        –°–æ–∑–¥–∞–µ—Ç –ø—Ä–æ–º–ø—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ—Ä–æ—Ç–∫–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∫–∞—Ä—Ç–æ—á–∫–∏ (1-2 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è).
        
        –°–æ–∑–¥–∞–µ—Ç –ø—Ä–æ–º–ø—Ç, —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–π –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Å—É—Ç–∏
        –∏–∑ –ø–æ–ª–Ω–æ–≥–æ –ø–æ—Å—Ç–∞ –∏ —Å–æ–∑–¥–∞–Ω–∏—è –∫—Ä–∞—Ç–∫–æ–π –≤–µ—Ä—Å–∏–∏ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–∞—Ö.
        
        Args:
            user_data (PromptContext): –î–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
            full_content (str): –ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç –ø–æ—Å—Ç–∞ –¥–ª—è —Å–æ–∫—Ä–∞—â–µ–Ω–∏—è
            
        Returns:
            str: –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∫–∞—Ä—Ç–æ—á–∫–∏
        """
        sections = [
            "–ó–∞–¥–∞—á–∞: —Å–æ–∑–¥–∞—Ç—å –∫–æ—Ä–æ—Ç–∫–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π –∫–∞—Ä—Ç–æ—á–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–ª–Ω–æ–≥–æ –ø–æ—Å—Ç–∞.",
        ]

        # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ –∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
        platform_requirements = self._get_platform_requirements(user_data.platform)
        sections.append(f"–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –∫–∞—Ä—Ç–æ—á–∫–∏: {user_data.platform} ({platform_requirements})")

        # –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∫–æ–Ω—Ç–µ–Ω—Ç—É –∫–∞—Ä—Ç–æ—á–∫–∏
        sections.extend([
            "–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∫–æ–Ω—Ç–µ–Ω—Ç—É –∫–∞—Ä—Ç–æ—á–∫–∏:",
            "‚Ä¢ –ú–∞–∫—Å–∏–º—É–º 1 –∫–æ—Ä–æ—Ç–∫–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ (4-8 —Å–ª–æ–≤)",
            "‚Ä¢ –î–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å—É—Ç—å –∏ –ø—Ä–∏–∑—ã–≤ –∫ –¥–µ–π—Å—Ç–≤–∏—é",
            "‚Ä¢ –ö—Ä–∞—Ç–∫–∏–π, –Ω–æ –ø—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç",
            "‚Ä¢ –ë–µ–∑ —Ö–µ—à—Ç–µ–≥–æ–≤ (–æ–Ω–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –æ—Ç–¥–µ–ª—å–Ω–æ)",
            "‚Ä¢ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —Å—Ç–∏–ª—å –ø–æ–≤–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è: –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–π, –≤–¥–æ—Ö–Ω–æ–≤–ª—è—é—â–∏–π",
        ])

        # –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –ù–ö–û –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
        if user_data.has_ngo_info and user_data.ngo_name:
            sections.extend([
                "\n–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –ù–ö–û:",
                f"‚Ä¢ –ù–∞–∑–≤–∞–Ω–∏–µ: {user_data.ngo_name}",
            ])
            if user_data.ngo_description and user_data.ngo_description != "–ù–µ —É–∫–∞–∑–∞–Ω–æ":
                sections.append(f"‚Ä¢ –ú–∏—Å—Å–∏—è: {user_data.ngo_description}")

        sections.extend([
            "\n–í–æ—Ç –ø–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç –ø–æ—Å—Ç–∞ –¥–ª—è —Å–æ–∫—Ä–∞—â–µ–Ω–∏—è:",
            full_content,
            "\n–°–æ–∑–¥–∞–π—Ç–µ –∫–æ—Ä–æ—Ç–∫—É—é –≤–µ—Ä—Å–∏—é —ç—Ç–æ–≥–æ –ø–æ—Å—Ç–∞ –¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π –∫–∞—Ä—Ç–æ—á–∫–∏ (1-2 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è).",
            "–û—Ç–≤–µ—á–∞–π—Ç–µ —Ç–æ–ª—å–∫–æ —Å–æ–∫—Ä–∞—â–µ–Ω–Ω—ã–º —Ç–µ–∫—Å—Ç–æ–º, –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤."
        ])

        prompt = "\n".join(sections)
        return textwrap.dedent(prompt).strip()

    def build_refactor_text_content_prompt(self, user_data: PromptContext, generated_post: str, user_text: str) -> str:
        """
        –°–æ–∑–¥–∞–µ—Ç –ø—Ä–æ–º–ø—Ç –¥–ª—è —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞.
        
        –°–æ–∑–¥–∞–µ—Ç –ø—Ä–æ–º–ø—Ç –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —Å–æ–≥–ª–∞—Å–Ω–æ
        —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —Å–æ—Ö—Ä–∞–Ω—è—è –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏ —Å—Ç–∏–ª—å.
        
        Args:
            user_data (PromptContext): –î–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
            generated_post (str): –¢–µ–∫—Å—Ç–æ–≤—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞
            user_text (str): –ó–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–µ
            
        Returns:
            str: –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
        """
        narrative_style = self._get_narrative_style(user_data.narrative_style)
        
        sections = [
            "–í—ã –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π SMM-–º–µ–Ω–µ–¥–∂–µ—Ä –ù–ö–û.",
            f"–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –ø–æ—Å—Ç —Å–æ–≥–ª–∞—Å–Ω–æ —ç—Ç–æ–º—É –∑–∞–ø—Ä–æ—Å—É: {user_text}",
            f"–°—Ç–∏–ª—å –ø–æ–≤–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è: {narrative_style}",
        ]

        # –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã
        if user_data.event_type or user_data.event_date:
            sections.extend([
                "–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:",
                f"‚Ä¢ –ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ: {user_data.event_type}",
                f"‚Ä¢ –î–∞—Ç–∞: {user_data.event_date}",
                f"‚Ä¢ –ú–µ—Å—Ç–æ: {user_data.event_place}",
                f"‚Ä¢ –ê—É–¥–∏—Ç–æ—Ä–∏—è: {user_data.event_audience}",
            ])

        # –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –ù–ö–û
        if user_data.has_ngo_info and user_data.ngo_name:
            sections.extend([
                "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –ù–ö–û:",
                f"‚Ä¢ –ù–∞–∑–≤–∞–Ω–∏–µ: {user_data.ngo_name}",
            ])
            if user_data.ngo_description and user_data.ngo_description != "–ù–µ —É–∫–∞–∑–∞–Ω–æ":
                sections.append(f"‚Ä¢ –û–ø–∏—Å–∞–Ω–∏–µ: {user_data.ngo_description}")
            if user_data.ngo_activities and user_data.ngo_activities != "–ù–µ —É–∫–∞–∑–∞–Ω–æ":
                sections.append(f"‚Ä¢ –î–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å: {user_data.ngo_activities}")
            if user_data.ngo_contact and user_data.ngo_contact != "–ù–µ —É–∫–∞–∑–∞–Ω–æ":
                sections.append(f"‚Ä¢ –ö–æ–Ω—Ç–∞–∫—Ç—ã: {user_data.ngo_contact}")

        sections.extend([
            f"–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞: {user_data.platform} ({self._get_platform_requirements(user_data.platform)})",
            "–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:",
            "‚Ä¢ –ù–µ —É–ø–æ–º–∏–Ω–∞—Ç—å —Ä–µ–∂–∏–º–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, –≤–æ–µ–Ω–Ω—ã–µ –±–∞–∑—ã –∏–ª–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ –ø–µ—Ä–µ–¥–≤–∏–∂–µ–Ω–∏–µ.",
            "‚Ä¢ –§–æ–∫—É—Å–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ —Å–æ—Ü–∏–∞–ª—å–Ω–æ–π –º–∏—Å—Å–∏–∏ –∏ –ø–æ–º–æ—â–∏ –ª—é–¥—è–º.",
            "‚Ä¢ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏ –ø—Ä–∏–∑—ã–≤ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –¥–µ–π—Å—Ç–≤–∏—é.",
            "‚Ä¢ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –¥–æ–±–∞–≤–∏—Ç—å 3-5 —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —Ö–µ—à—Ç–µ–≥–æ–≤ –≤ –∫–æ–Ω—Ü–µ –ø–æ—Å—Ç–∞.",
        ])

        sections.append("–í–æ—Ç –ø–æ—Å—Ç –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:")
        sections.append(generated_post)

        sections.append(
            "–û—Ç–≤–µ—á–∞–π—Ç–µ —Ç–æ–ª—å–∫–æ –≥–æ—Ç–æ–≤—ã–º –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Ç–µ–∫—Å—Ç–æ–º –ø–æ—Å—Ç–∞, –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤."
        )
        
        prompt = "\n".join(sections)
        return textwrap.dedent(prompt).strip()

    def build_content_plan_prompt(self, user_data: PlanPromptContext) -> str:
        """
        –°–æ–∑–¥–∞–µ—Ç –ø—Ä–æ–º–ø—Ç –¥–ª—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞.
        
        –°–æ–∑–¥–∞–µ—Ç –ø—Ä–æ–º–ø—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã—Ö –∫–æ–Ω—Ç–µ–Ω—Ç-–ø–ª–∞–Ω–æ–≤,
        –≤–∫–ª—é—á–∞—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –ø—É–±–ª–∏–∫–∞—Ü–∏–π, —Ç–µ–º—ã –∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏.
        
        Args:
            user_data (PlanPromptContext): –î–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–ª—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
            
        Returns:
            str: –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç-–ø–ª–∞–Ω–∞
        """
        period = user_data.period
        frequency = user_data.frequency
        themes = user_data.themes
        details = user_data.details

        sections = [
            "–ó–∞–¥–∞—á–∞: —Å–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç-–ø–ª–∞–Ω –¥–ª—è –∞–∫–∫–∞—É–Ω—Ç–∞ –ù–ö–û –≤ —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–µ—Ç—è—Ö. –£–∫–∞–∂–∏—Ç–µ –¥–Ω–∏ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ—Å—Ç–æ–≤.",
            "–ö–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è:",
            f"‚Ä¢ –ü–µ—Ä–∏–æ–¥: {period}",
            f"‚Ä¢ –ß–∞—Å—Ç–æ—Ç–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–π: {frequency}",
            f"‚Ä¢ –¢–µ–º—ã: {themes}",
        ]

        if details:
            sections.append(f"‚Ä¢ –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è: {details}")

        sections.extend([
            "–¢–∞–∫–∂–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è, –ø–æ—á–µ–º—É –≤—ã –ø—Ä–µ–¥–ª–æ–∂–∏–ª–∏ –∏–º–µ–Ω–Ω–æ —Ç–∞–∫–æ–π –ø–ª–∞–Ω.",
            "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Ç—Å—Ç—É–ø—ã, —Å–ø–∏—Å–∫–∏ –∏ —ç–º–æ–¥–∑–∏ –¥–ª—è –ª—É—á—à–µ–π —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏. –ù–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞–π—Ç–µ —Ç–µ–∫—Å—Ç.",
            "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞, –∫–æ—Ç–æ—Ä–æ–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ Telegram.",
        ])

        prompt = "\n".join(sections)
        return textwrap.dedent(prompt).strip()

    def build_edit_text_prompt(self, user_data: EditPromptContext) -> str:
        """
        –°–æ–∑–¥–∞–µ—Ç –ø—Ä–æ–º–ø—Ç –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –≤—ã—á–∏—Ç–∫–∏ —Ç–µ–∫—Å—Ç–∞.
        
        –°–æ–∑–¥–∞–µ—Ç –ø—Ä–æ–º–ø—Ç –¥–ª—è –≥—Ä–∞–º–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ, –ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –∏ —Å—Ç–∏–ª–∏—Å—Ç–∏—á–µ—Å–∫–æ–≥–æ
        —É–ª—É—á—à–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞, —Å–æ—Ö—Ä–∞–Ω—è—è –ø—Ä–∏ —ç—Ç–æ–º –æ—Å–Ω–æ–≤–Ω—É—é —Ç–µ–º—É.
        
        Args:
            user_data (EditPromptContext): –î–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–∞
            
        Returns:
            str: –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–∞
        """
        text_to_edit = user_data.text_to_edit
        details = user_data.details

        sections = [
            "–ó–∞–¥–∞—á–∞: –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç –Ω–∞ –≥—Ä–∞–º–º–∞—Ç–∏–∫—É, –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏—é, –ª–æ–≥–∏–∫—É –∏ —Å—Ç–∏–ª—å. ",
            "–ü–æ—Å—Ç–∞—Ä–∞—Ç—å—Å—è —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ—Å–Ω–æ–≤–Ω—É—é —Ç–µ–º—É –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞. ",
            "–ü–æ–∫–∞–∑–∞—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é –∏ –ø–µ—Ä–µ—á–∏—Å–ª–∏—Ç—å, –∫–∞–∫–∏–µ –æ—à–∏–±–∫–∏ –±—ã–ª–∏ –Ω–∞–π–¥–µ–Ω—ã –∏ –∫–∞–∫ –æ–Ω–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã.",
            f"–ò—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç: {text_to_edit}",
        ]

        # –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –ù–ö–û, –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–∞
        if user_data.has_ngo_info and user_data.ngo_name:
            sections.extend([
                "",
                "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –ù–ö–û (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏, –µ—Å–ª–∏ –æ–Ω–∞ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–∞):",
                f"‚Ä¢ –ù–∞–∑–≤–∞–Ω–∏–µ: {user_data.ngo_name}",
            ])
            if user_data.ngo_description and user_data.ngo_description != "–ù–µ —É–∫–∞–∑–∞–Ω–æ":
                sections.append(f"‚Ä¢ –û–ø–∏—Å–∞–Ω–∏–µ: {user_data.ngo_description}")
            if user_data.ngo_activities and user_data.ngo_activities != "–ù–µ —É–∫–∞–∑–∞–Ω–æ":
                sections.append(f"‚Ä¢ –î–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å: {user_data.ngo_activities}")
            if user_data.ngo_contact and user_data.ngo_contact != "–ù–µ —É–∫–∞–∑–∞–Ω–æ":
                sections.append(f"‚Ä¢ –ö–æ–Ω—Ç–∞–∫—Ç—ã: {user_data.ngo_contact}")
            sections.append("–ï—Å–ª–∏ –≤ —Ç–µ–∫—Å—Ç–µ —É–ø–æ–º–∏–Ω–∞–µ—Ç—Å—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –ù–ö–û –¥–ª—è —É—Ç–æ—á–Ω–µ–Ω–∏—è.")

        if details:
            sections.append(f"–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ—Ç–∞–ª–∏ –¥–ª—è —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏—è –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —Ç–µ–∫—Å—Ç–∞: {details}")

        prompt = "\n".join(sections)
        return textwrap.dedent(prompt).strip()

    @staticmethod
    def _normalize_to_list(value: Union[str, Iterable[str]]) -> List[str]:
        """
        –ù–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –≤ —Å–ø–∏—Å–æ–∫ —Å—Ç—Ä–æ–∫, –∏–≥–Ω–æ—Ä–∏—Ä—É—è –∑–Ω–∞—á–µ–Ω–∏—è None.
        
        Args:
            value (Union[str, Iterable[str]]): –ó–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏
            
        Returns:
            List[str]: –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Å—Ç—Ä–æ–∫
        """
        if value is None:
            return []
        if isinstance(value, str):
            value = value.strip()
            return [value] if value else []
        if isinstance(value, Iterable):
            result = []
            for item in value:
                if item is None:
                    continue
                if isinstance(item, str):
                    item = item.strip()
                    if item:
                        result.append(item)
                else:
                    result.append(str(item))
            return result
        return [str(value)]

    @staticmethod
    def _get_narrative_style(style: str) -> str:
        """
        –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å—Ç–∏–ª—å –ø–æ–≤–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—ã–±–æ—Ä–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
        
        Args:
            style (str): –ü—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–µ —Å—Ç–∏–ª—è, –≤—ã–±—Ä–∞–Ω–Ω–æ–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
            
        Returns:
            str: –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Å—Ç–∏–ª—è –¥–ª—è –ø—Ä–æ–º–ø—Ç–∞
        """
        style_lower = style.lower()
        
        if "—Ä–∞–∑–≥–æ–≤–æ—Ä–Ω—ã–π" in style_lower:
            return "–¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π, –ø—Ä–æ—Å—Ç–æ–π —è–∑—ã–∫, –∫–∞–∫ —Ä–∞–∑–≥–æ–≤–æ—Ä —Å –±–ª–∏–∑–∫–∏–º –¥—Ä—É–≥–æ–º, –∏—Å–ø–æ–ª—å–∑—É–π –ª–∏—á–Ω—ã–µ –º–µ—Å—Ç–æ–∏–º–µ–Ω–∏—è –∏ —ç–º–æ–¥–∑–∏"
        elif "–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ-–¥–µ–ª–æ–≤–æ–π" in style_lower:
            return "–ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π, —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π, –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Ç–æ–Ω, —á–µ—Ç–∫–∏–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏"
        elif "—Ö—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π" in style_lower:
            return "–æ–±—Ä–∞–∑–Ω—ã–π, —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π, –∏—Å–ø–æ–ª—å–∑—É–π –º–µ—Ç–∞—Ñ–æ—Ä—ã –∏ —è—Ä–∫–∏–µ –æ–ø–∏—Å–∞–Ω–∏—è"
        elif "–ø–æ–∑–∏—Ç–∏–≤–Ω—ã–π" in style_lower or "–º–æ—Ç–∏–≤–∏—Ä—É—é—â–∏–π" in style_lower:
            return "–≤–¥–æ—Ö–Ω–æ–≤–ª—è—é—â–∏–π, —ç–Ω–µ—Ä–≥–∏—á–Ω—ã–π, —Å –∞–∫—Ü–µ–Ω—Ç–æ–º –Ω–∞ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ —ç–º–æ—Ü–∏–∏ –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏"
        else:
            return "—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π, –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π, –Ω–æ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π"

    @staticmethod
    def _get_audience_style(audience: List[str]) -> str:
        """
        –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å—Ç–∏–ª—å —Ç–µ–∫—Å—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ü–µ–ª–µ–≤–æ–π –∞—É–¥–∏—Ç–æ—Ä–∏–∏.
        
        Args:
            audience (List[str]): –°–ø–∏—Å–æ–∫ —Å–µ–≥–º–µ–Ω—Ç–æ–≤ –∞—É–¥–∏—Ç–æ—Ä–∏–∏
            
        Returns:
            str: –û–ø–∏—Å–∞–Ω–∏–µ —Å—Ç–∏–ª—è, –ø–æ–¥—Ö–æ–¥—è—â–µ–≥–æ –¥–ª—è –∞—É–¥–∏—Ç–æ—Ä–∏–∏
        """
        audience_lower = ", ".join(audience).lower()

        if any(key in audience_lower for key in ("–º–æ–ª–æ–¥–µ–∂—å", "14-25", "—Å—Ç—É–¥–µ–Ω—Ç—ã")):
            return "–Ω–µ—Ñ–æ—Ä–º–∞–ª—å–Ω—ã–π, —ç–Ω–µ—Ä–≥–∏—á–Ω—ã–π, —Å —ç–º–æ–¥–∑–∏ –≤ –Ω–∞—á–∞–ª–µ –∞–±–∑–∞—Ü–µ–≤, —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å–ª–µ–Ω–≥"
        if any(key in audience_lower for key in ("—Å–µ–º—å–∏ —Å –¥–µ—Ç—å–º–∏", "—Ä–æ–¥–∏—Ç–µ–ª–∏")):
            return "—Ç–µ–ø–ª—ã–π, –∑–∞–±–æ—Ç–ª–∏–≤—ã–π, –±–µ–∑ –∂–∞—Ä–≥–æ–Ω–∞, —Å –∞–∫—Ü–µ–Ω—Ç–æ–º –Ω–∞ —Å–µ–º–µ–π–Ω—ã–µ —Ü–µ–Ω–Ω–æ—Å—Ç–∏"
        if any(key in audience_lower for key in ("–±–∏–∑–Ω–µ—Å", "–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏", "–∫–æ–º–ø–∞–Ω–∏–∏")):
            return (
                "–ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π, —Å –∞–∫—Ü–µ–Ω—Ç–æ–º –Ω–∞ —Å–æ—Ü–∏–∞–ª—å–Ω—É—é –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∏ –∏–∑–º–µ—Ä–∏–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã"
            )
        if any(key in audience_lower for key in ("–ø–æ–∂–∏–ª—ã–µ", "45+", "—Å—Ç–∞—Ä—à–µ–µ –ø–æ–∫–æ–ª–µ–Ω–∏–µ")):
            return "—É–≤–∞–∂–∏—Ç–µ–ª—å–Ω—ã–π, –ø–æ–Ω—è—Ç–Ω—ã–π, –±–µ–∑ —Å–ª–æ–∂–Ω—ã—Ö —Ç–µ—Ä–º–∏–Ω–æ–≤, —Å –∞–∫—Ü–µ–Ω—Ç–æ–º –Ω–∞ —Ç—Ä–∞–¥–∏—Ü–∏–∏ –∏ –∑–∞–±–æ—Ç—É"
        return "—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π, –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π, –Ω–æ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π"

    @staticmethod
    def _get_platform_requirements(platform: str) -> str:
        """
        –ü–æ–ª—É—á–∞–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—é –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã.
        
        Args:
            platform (str): –¶–µ–ª–µ–≤–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–µ—Ç–µ–π
            
        Returns:
            str: –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—é –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
        """
        platform_lower = platform.lower()

        if any(key in platform_lower for key in ("–≤–∫–æ–Ω—Ç–∞–∫—Ç–µ", "vk", "–≤–∫")):
            return (
                "3-5 —ç–º–æ–¥–∑–∏ –≤ —Ç–µ–∫—Å—Ç–µ, 3-5 —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —Ö–µ—à—Ç–µ–≥–æ–≤ –≤ –∫–æ–Ω—Ü–µ, –∫–æ—Ä–æ—Ç–∫–∏–µ –∞–±–∑–∞—Ü—ã (1-2 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è)"
            )
        if any(key in platform_lower for key in ("telegram", "—Ç–µ–ª–µ–≥—Ä–∞–º", "tg")):
            return (
                "–∏—Å–ø–æ–ª—å–∑—É–π **–∂–∏—Ä–Ω—ã–π** –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤, --- –¥–ª—è —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–π, 1-2 –∫–ª—é—á–µ–≤—ã—Ö —Ö–µ—à—Ç–µ–≥–∞, –º–∏–Ω–∏–º—É–º —ç–º–æ–¥–∑–∏"
            )
        if any(key in platform_lower for key in ("—Å–∞–π—Ç", "—Ä–∞—Å—Å—ã–ª–∫–∞", "newsletter")):
            return "–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å—Ç–∏–ª—å, –ø–æ–ª–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è, –±–µ–∑ —ç–º–æ–¥–∑–∏"
        return "—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –¥–ª—è —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–µ—Ç–µ–π"

    @staticmethod
    def _format_event_details(event_details: Union[str, Dict]) -> str:
        """
        –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –¥–µ—Ç–∞–ª–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è –≤ –ø—Ä–æ–º–ø—Ç.
        
        Args:
            event_details (Union[str, Dict]): –î–µ—Ç–∞–ª–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
            
        Returns:
            str: –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–µ—Ç–∞–ª–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ —à–∞–±–ª–æ–Ω–∞
        """
        if isinstance(event_details, dict):
            parts = []
            for key, value in event_details.items():
                if value:
                    parts.append(f"{key.capitalize()}: {value}")
            event_text = "; ".join(parts)
        else:
            event_text = str(event_details).strip()

        template = textwrap.dedent(
            """
            ‚Ä¢ –£–∫–∞–∂–∏—Ç–µ —Ç–æ—á–Ω—É—é –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è.
            ‚Ä¢ –£–∫–∞–∂–∏—Ç–µ –º–µ—Å—Ç–æ (–±–µ–∑ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è –∑–∞–∫—Ä—ã—Ç—ã—Ö —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–π).
            ‚Ä¢ –û–±—ä—è—Å–Ω–∏—Ç–µ, –∑–∞—á–µ–º –Ω—É–∂–Ω–æ —ç—Ç–æ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ –∏ —á—Ç–æ –±—É–¥–µ—Ç –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–≥–æ.
            ‚Ä¢ –†–∞—Å—Å–∫–∞–∂–∏—Ç–µ, —á—Ç–æ –ø–æ–ª—É—á–∞—Ç —É—á–∞—Å—Ç–Ω–∏–∫–∏.
            ‚Ä¢ –î–æ–±–∞–≤—å—Ç–µ —Å—Ä–æ—á–Ω—ã–π –ø—Ä–∏–∑—ã–≤ –∫ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏, –µ—Å–ª–∏ –µ—Å—Ç—å –¥–µ–¥–ª–∞–π–Ω.
            """
        ).strip()

        return f"{event_text}\n{template}"
